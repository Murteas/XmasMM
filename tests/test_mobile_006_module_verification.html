<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MOBILE-006 Module Loading Verification</title>
</head>
<body>
  <h1>MOBILE-006 Module Loading Test</h1>
  <div id="test-results"></div>
  
  <script src="../js/utils/ModuleLoader.js"></script>
  <script>
    async function testModuleLoading() {
      const resultsDiv = document.getElementById('test-results');
      
      try {
        resultsDiv.innerHTML += '<p>‚è≥ Starting module loading test...</p>';
        
        // Load modules using ModuleLoader
        await window.ModuleLoader.initializeGame('../');
        resultsDiv.innerHTML += '<p>‚úÖ ModuleLoader completed successfully</p>';
        
        // Test if ScrollableHistoryManager is available
        if (typeof ScrollableHistoryManager === 'undefined') {
          resultsDiv.innerHTML += '<p>‚ùå ScrollableHistoryManager not found after module loading</p>';
          return false;
        } else {
          resultsDiv.innerHTML += '<p>‚úÖ ScrollableHistoryManager loaded successfully</p>';
        }
        
        // Test if MobileScrollService is available
        if (typeof MobileScrollService === 'undefined') {
          resultsDiv.innerHTML += '<p>‚ùå MobileScrollService not found after module loading</p>';
          return false;
        } else {
          resultsDiv.innerHTML += '<p>‚úÖ MobileScrollService loaded successfully</p>';
        }
        
        // Try to create instances to verify they work
        const mockScene = {
          cameras: { main: { width: 400, height: 600 } },
          add: {
            container: () => ({ setDepth: () => ({}), add: () => ({}) }),
            rectangle: () => ({ setInteractive: () => ({}), setDepth: () => ({}), on: () => ({}) })
          },
          time: { delayedCall: () => ({}) },
          tweens: { add: () => ({}) },
          make: { graphics: () => ({ fillStyle: () => ({}), fillRect: () => ({}), createGeometryMask: () => ({}) }) }
        };
        
        try {
          const scrollService = new MobileScrollService(mockScene);
          resultsDiv.innerHTML += '<p>‚úÖ MobileScrollService instantiates successfully</p>';
          
          const scrollableManager = new ScrollableHistoryManager(mockScene);
          resultsDiv.innerHTML += '<p>‚úÖ ScrollableHistoryManager instantiates successfully</p>';
          
          resultsDiv.innerHTML += '<p><strong>üéâ MOBILE-006 MODULE LOADING FIX VERIFIED!</strong></p>';
          return true;
        } catch (error) {
          resultsDiv.innerHTML += `<p>‚ùå Instantiation failed: ${error.message}</p>`;
          return false;
        }
        
      } catch (error) {
        resultsDiv.innerHTML += `<p>‚ùå Module loading failed: ${error.message}</p>';
        console.error('MOBILE-006 test error:', error);
        return false;
      }
    }
    
    // Run test when page loads
    window.addEventListener('load', testModuleLoading);
  </script>
</body>
</html>
