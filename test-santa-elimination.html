<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Santa Position 4 Test</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #0a0a0a; color: #00ff00; }
        .test { margin: 20px 0; padding: 15px; border: 2px solid #00ff00; }
        .pass { border-color: #00ff00; }
        .fail { border-color: #ff0000; color: #ffaaaa; }
    </style>
</head>
<body>
    <h1>üß™ Test: Can Santa be at Position 4?</h1>
    <p>Guess: [Santa, Santa, Santa, Santa, Tree]</p>
    <p>Feedback: 1‚ö´ 0‚ö™ (1 black, 0 white)</p>
    <p>Question: Is Santa possible at position 4?</p>

    <div id="results"></div>

    <script src="js/utils/ConstraintSolver.js"></script>
    <script>
        const results = document.getElementById('results');

        function calculateFeedback(guess, code) {
            let black = 0, white = 0;
            const guessCopy = [...guess];
            const codeCopy = [...code];

            // First pass: blacks
            for (let i = guessCopy.length - 1; i >= 0; i--) {
                if (guessCopy[i] === codeCopy[i]) {
                    black++;
                    guessCopy.splice(i, 1);
                    codeCopy.splice(i, 1);
                }
            }

            // Second pass: whites
            for (let i = 0; i < guessCopy.length; i++) {
                const index = codeCopy.indexOf(guessCopy[i]);
                if (index !== -1) {
                    white++;
                    codeCopy.splice(index, 1);
                }
            }

            return { black, white };
        }

        const guess = ['Santa', 'Santa', 'Santa', 'Santa', 'Tree'];
        const expectedFeedback = { black: 1, white: 0 };

        // Test various codes with Santa at position 4
        const testCodes = [
            ['Santa', 'Present', 'Star', 'Candy Cane', 'Santa'],
            ['Present', 'Santa', 'Star', 'Candy Cane', 'Santa'],
            ['Present', 'Star', 'Santa', 'Candy Cane', 'Santa'],
            ['Present', 'Star', 'Candy Cane', 'Santa', 'Santa'],
            ['Present', 'Star', 'Candy Cane', 'Snowflake', 'Santa'],
        ];

        let html = '<h2>Testing codes with Santa at position 4:</h2>';

        testCodes.forEach(code => {
            const feedback = calculateFeedback(guess, code);
            const matches = feedback.black === expectedFeedback.black &&
                           feedback.white === expectedFeedback.white;

            html += `<div class="test ${matches ? 'pass' : 'fail'}">`;
            html += `<strong>Code:</strong> [${code.join(', ')}]<br>`;
            html += `<strong>Feedback:</strong> ${feedback.black}‚ö´ ${feedback.white}‚ö™<br>`;
            html += `<strong>Expected:</strong> ${expectedFeedback.black}‚ö´ ${expectedFeedback.white}‚ö™<br>`;
            html += `<strong>Match:</strong> ${matches ? '‚úÖ YES' : '‚ùå NO'}`;
            html += `</div>`;
        });

        // Now test the actual secret code
        html += '<h2>Actual secret code from your game:</h2>';
        const actualCode = ['Santa', 'Present', 'Star', 'Candy Cane', 'Star'];
        const actualFeedback = calculateFeedback(guess, actualCode);
        const actualMatches = actualFeedback.black === expectedFeedback.black &&
                             actualFeedback.white === expectedFeedback.white;

        html += `<div class="test ${actualMatches ? 'pass' : 'fail'}">`;
        html += `<strong>Code:</strong> [${actualCode.join(', ')}]<br>`;
        html += `<strong>Feedback:</strong> ${actualFeedback.black}‚ö´ ${actualFeedback.white}‚ö™<br>`;
        html += `<strong>Expected:</strong> ${expectedFeedback.black}‚ö´ ${expectedFeedback.white}‚ö™<br>`;
        html += `<strong>Match:</strong> ${actualMatches ? '‚úÖ YES - This is the actual code' : '‚ùå NO'}`;
        html += `</div>`;

        results.innerHTML = html;

        console.log('Test complete. Check results above.');
    </script>
</body>
</html>
